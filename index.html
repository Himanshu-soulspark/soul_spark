<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome & Home</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&family=Exo+2:wght@800&display=swap" rel="stylesheet">
    
    <!-- Razorpay Script (यह पेमेंट के लिए ज़रूरी है) -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
</script>

<style>
    /* Basic body styling */
    body {
        margin: 0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        overflow-x: hidden; /* Prevents horizontal scrollbars */
        background-color: #f0f2f5;
    }

    /* Splash screen container */
    #splash-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle, #0077a2, #003f5c);
        display: flex;
        flex-direction: column; /* Centering content vertically */
        justify-content: center;
        align-items: center;
        transition: opacity 1.5s ease-out, visibility 1.5s;
        z-index: 100;
        overflow: hidden;
    }
    
    /* Animated background elements (more subtle) */
    #splash-screen::before, #splash-screen::after {
        content: '';
        position: absolute;
        width: 250px;
        height: 250px;
        background: rgba(255, 255, 255, 0.04);
        border-radius: 50%;
        animation: float 25s infinite linear;
        z-index: 1;
    }
    #splash-screen::before { top: -80px; left: -80px; }
    #splash-screen::after { bottom: -80px; right: -80px; animation-delay: -12.5s; }

    @keyframes float {
        0% { transform: translateY(0) translateX(0); }
        50% { transform: translateY(20px) translateX(-20px); }
        100% { transform: translateY(0) translateX(0); }
    }

    /* Caduceus Icon (w.jpg) */
    #caduceus-icon {
        width: clamp(80px, 20vw, 150px); /* Adjust size as needed */
        height: clamp(80px, 20vw, 150px); /* Make height equal to width for circle */
        border-radius: 50%; /* Make it circular */
        object-fit: cover; /* Ensure image covers the circle */
        margin-bottom: 20px; /* Space between icon and welcome text */
        z-index: 10;
        opacity: 0;
        animation: text-focus-in 1.5s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;
        animation-delay: 0.2s; /* Appear slightly before welcome text */
    }

    /* Welcome & Shubhmed Texts */
    .splash-text {
        font-family: 'Exo 2', sans-serif;
        font-weight: 800;
        color: white;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.9), 0 0 25px rgba(0, 255, 255, 0.7), 0 0 45px rgba(0, 0, 0, 0.5);
        letter-spacing: 3px;
        z-index: 10;
        opacity: 0;
        filter: blur(10px);
        animation: text-focus-in 1.5s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;
    }
    #welcome-text {
        font-size: clamp(3.5em, 14vw, 7em); /* Made bigger */
        animation-delay: 0.5s;
        margin-bottom: 10px; /* Pushed down slightly */
    }
    #shubhmed-text {
        font-size: clamp(1.2em, 5vw, 2.2em); /* Made smaller */
        margin-top: -20px; /* Adjusted position */
        animation-delay: 0.8s;
    }

    /* Tagline */
    #tagline {
        font-family: 'Poppins', sans-serif; /* Changed to Poppins for a different feel */
        font-weight: 700;
        color: white;
        text-shadow: 0 0 8px rgba(255, 255, 255, 0.8), 0 0 20px rgba(0, 255, 255, 0.6);
        letter-spacing: 1px;
        font-size: clamp(0.9em, 4vw, 1.5em); /* Adjust size as needed */
        text-align: center;
        margin-top: 15px; /* Space below model card */
        z-index: 10;
        opacity: 0;
        filter: blur(8px);
        animation: text-focus-in 1.5s cubic-bezier(0.550, 0.085, 0.680, 0.530) forwards;
        animation-delay: 1.5s; /* Appear after model card */
        line-height: 1.4;
    }


    /* 1:1 Card for 3D Model */
    .model-card {
        width: 80%; /* Made smaller */
        max-width: 320px; /* Made smaller */
        aspect-ratio: 1 / 1;
        margin: 20px 0;
        border-radius: 25px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3), inset 0 0 15px rgba(0, 230, 255, 0.5);
        border: 2px solid rgba(0, 230, 255, 0.7);
        z-index: 10;
        opacity: 0;
        transform: scale(0.8);
        animation: card-appear 1.5s cubic-bezier(0.550, 0.085, 0.680, 0.530) 1.2s forwards;
    }
    
    /* MODIFIED: Styling for the new welcome image */
    #welcome-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }
    
    @keyframes card-appear {
        100% { opacity: 1; transform: scale(1); }
    }

    @keyframes text-focus-in {
        0% { filter: blur(12px); opacity: 0; }
        100% { filter: blur(0px); opacity: 1; }
    }

    /* Buffer Loader */
    #buffer-loader {
        width: 60px; height: 60px; border: 5px solid rgba(0, 230, 255, 0.3);
        border-top-color: #00e5ff; border-radius: 50%;
        animation: spin 1.5s linear infinite; z-index: 15;
        display: none; margin-top: 20px;
    }
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }

    /* 3D Glowing Get Started button */
    #start-button {
        padding: 18px 40px; font-size: 1.3em; font-weight: bold;
        cursor: pointer; color: white; background: #008CBA;
        border: none; border-radius: 15px; margin-top: 20px;
        display: none; /* Hidden by default */
        box-shadow: 0 8px 0 #005f7a, 0 12px 20px rgba(0,0,0,0.4), 0 0 10px #00e5ff, inset 0 0 5px rgba(255,255,255,0.5);
        text-shadow: 0 0 5px #fff, 0 0 10px #00e5ff;
        transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        z-index: 10; animation: glowing-button 2s infinite ease-in-out;
    }
    @keyframes glowing-button {
        0%, 100% { box-shadow: 0 8px 0 #005f7a, 0 12px 20px rgba(0,0,0,0.4), 0 0 10px #00e5ff, inset 0 0 5px rgba(255,255,255,0.5); }
        50% { box-shadow: 0 8px 0 #005f7a, 0 12px 20px rgba(0,0,0,0.4), 0 0 25px #00e5ff, inset 0 0 10px rgba(255,255,255,0.8); }
    }
    #start-button:hover { transform: translateY(-2px); }
    #start-button:active { transform: translateY(4px); box-shadow: 0 4px 0 #005f7a, 0 8px 15px rgba(0,0,0,0.35); }

    /* Dashboard Selection Screen */
    #dashboard-selection-screen {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: #f0f2f5; display: none; flex-direction: column;
        justify-content: center; align-items: center; z-index: 90;
        padding: 20px; box-sizing: border-box;
    }
    .dashboard-btn {
        width: 100%; max-width: 400px; padding: 20px; margin: 15px 0;
        font-size: 1.2em; font-weight: bold; color: #fff;
        background: linear-gradient(145deg, #0097c9, #007095); border: none;
        border-radius: 12px; cursor: pointer;
        box-shadow: 0 6px 0 #004d66, 0 10px 18px rgba(0,0,0,0.3);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        transition: all 0.2s ease-in-out;
    }
    .dashboard-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 0 #004d66, 0 12px 20px rgba(0,0,0,0.35); }
    .dashboard-btn:active { transform: translateY(3px); box-shadow: 0 3px 0 #004d66, 0 6px 12px rgba(0,0,0,0.3); }

    /* General Page Styling */
    .page {
        display: none; flex-direction: column; width: 100%;
        min-height: 100vh; box-sizing: border-box;
    }
    #header { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        padding: 12px 15px; 
        background-color: #ffffff; 
        border-bottom: 1px solid #ddd; 
        box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        position: sticky; 
        top: 0; 
        z-index: 50; 
    }
    .menu-icon { font-size: 28px; cursor: pointer; color: #333; padding: 5px; }
    .search-container { 
        display: flex; 
        align-items: center; 
        flex-grow: 1; 
        margin: 0 10px; /* Reduced margin for better fit */
        border: 1px solid #ccc; /* Added border to container */
        border-radius: 50px; /* Rounded overall search bar */
        overflow: hidden; /* To keep inner elements rounded */
    }
    .search-bar { 
        width: 100%; 
        padding: 10px 15px; 
        border: none; /* Removed individual border */
        outline: none; 
        font-size: 16px; 
        background-color: transparent; /* Ensure transparent background */
    }
    .search-button { 
        padding: 10px 15px; 
        border: none; /* Removed individual border */
        background-color: #f8f8f8; 
        cursor: pointer; 
        border-radius: 0; /* No specific rounding here, let container handle it */
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0; /* Prevent shrinking */
    }

    /* Coin Icon in Header */
    .coin-display {
        display: flex;
        align-items: center;
        margin-left: 10px; /* Space from search bar */
        font-weight: bold;
        color: #333;
        flex-shrink: 0; /* Prevent shrinking */
    }
    .coin-display .coin-icon-emoji {
        font-size: 24px;
        margin-right: 5px;
    }
    /* Specific styling for the profile page header elements */
    #profile-page #header .menu-icon,
    #profile-page #header .search-container,
    #profile-page #header .coin-display {
        display: none;
    }
    /* Adjust header for profile page to center "Welcome & Home" text */
    #profile-page #header {
        justify-content: center;
    }
    #profile-page #header > div:first-child { /* Targets the "Welcome & Home" div */
        margin: 0 auto; /* Centers the title */
    }

    .main-content { padding: 15px; overflow-y: auto; flex-grow: 1; padding-bottom: 85px; /* Space for bottom nav */ }
    .card-16-9 { width: 100%; padding-top: 56.25%; position: relative; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 25px rgba(0,0,0,0.15); cursor: pointer; margin-bottom: 20px;}
    .card-16-9 img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
    
    .action-button { display: block; width: 100%; margin-bottom: 20px; padding: 15px 20px; font-size: 1.2em; font-weight: bold; color: white; background: linear-gradient(145deg, #4CAF50, #2E7D32); border: none; border-radius: 12px; cursor: pointer; box-shadow: 0 6px 0 #1B5E20, 0 10px 18px rgba(0,0,0,0.3); transition: all 0.2s ease-in-out; }
    .action-button:hover { transform: translateY(-2px); box-shadow: 0 8px 0 #1B5E20, 0 12px 20px rgba(0,0,0,0.35); }

    .cards-1-1-container { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px; }
    .card-1-1 { width: 100%; aspect-ratio: 1 / 1; border-radius: 15px; overflow: hidden; box-shadow: 0 8px 25px rgba(0,0,0,0.15); cursor: pointer; position: relative; transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .card-1-1:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(0,0,0,0.2); }
    .card-1-1 img { width: 100%; height: 100%; object-fit: cover; }

    .features-container-16-9 {
        position: relative; width: 100%; padding-top: 56.25%; border-radius: 15px;
        overflow: hidden; background: #fff; box-shadow: 0 8px 25px rgba(0,0,0,0.1); margin-top: 15px;
    }
    .features-section {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        padding: 15px; box-sizing: border-box; overflow-y: scroll; /* Changed to scroll */
    }
    .features-section h2 { text-align: center; font-size: 1.6em; color: #333; margin-top: 0; margin-bottom: 15px; }
    .features-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px, 1fr)); gap: 15px; }
    .feature-item { 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        text-align: center; 
        cursor: pointer; 
        transition: transform 0.3s, box-shadow 0.3s;
        background-color: #f9f9f9;
        padding: 10px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* Subtle 3D effect */
    }
    .feature-item:hover { 
        transform: translateY(-5px); 
        box-shadow: 0 8px 16px rgba(0,0,0,0.2); 
    }
    .feature-item svg { 
        width: 40px; 
        height: 40px; 
        fill: #008CBA; 
        margin-bottom: 8px; 
        filter: drop-shadow(0 0 5px rgba(0,230,255,0.5)); /* 3D sticker effect */
    }
    .feature-item span { font-size: 0.8em; color: #555; font-weight: 600; }

    /* Care Page Specific Styles */
    .care-page-grid { display: flex; flex-direction: column; gap: 25px; }
    .care-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
    .care-card-wrapper { display: flex; flex-direction: column; align-items: center; }
    .care-card-wrapper img { width: 100%; aspect-ratio: 1 / 1; border-radius: 15px; object-fit: cover; box-shadow: 0 8px 25px rgba(0,0,0,0.15); background-color: #e0e0e0; }
    .care-card-wrapper-16-9 { width: 100%; }
    .care-card-wrapper-16-9 img { width: 100%; aspect-ratio: 16 / 9; border-radius: 15px; object-fit: cover; box-shadow: 0 8px 25px rgba(0,0,0,0.15); background-color: #e0e0e0; }
    .care-3d-btn {
        width: 90%; padding: 12px; margin-top: 15px; font-size: 1em; font-weight: bold; color: #fff;
        background: linear-gradient(145deg, #0097c9, #007095); border: none;
        border-radius: 12px; cursor: pointer;
        box-shadow: 0 5px 0 #004d66, 0 8px 15px rgba(0,0,0,0.25);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2); transition: all 0.2s ease-in-out;
        text-align: center;
        white-space: nowrap; /* Ensures text is on one line */
    }
    .care-3d-btn:hover { transform: translateY(-2px); box-shadow: 0 7px 0 #004d66, 0 10px 18px rgba(0,0,0,0.3); }
    .care-3d-btn:active { transform: translateY(2px); box-shadow: 0 3px 0 #004d66, 0 5px 12px rgba(0,0,0,0.3); }

    /* Tracker Page Specific Styles */
    .tracker-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); /* Adjusted for smaller screens */
        gap: 20px;
        margin-top: 20px;
    }
    .tracker-card-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: #fff;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        padding-bottom: 15px; /* Space for the button */
    }
    .tracker-card-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 30px rgba(0,0,0,0.2);
    }
    .tracker-card-item img {
        width: 100%;
        aspect-ratio: 1 / 1; /* 1:1 ratio for image part */
        object-fit: cover;
        border-radius: 15px 15px 0 0; /* Only top corners rounded for image */
        margin-bottom: 10px;
    }
    .tracker-btn {
        width: calc(100% - 20px); /* Account for padding */
        padding: 12px 15px;
        font-size: 0.9em; /* MODIFIED: Slightly smaller font size to prevent overflow */
        font-weight: bold;
        color: #fff;
        background: linear-gradient(145deg, #0097c9, #007095);
        border: none;
        border-radius: 10px; /* Slightly smaller border-radius for button */
        cursor: pointer;
        box-shadow: 0 5px 0 #004d66, 0 8px 15px rgba(0,0,0,0.25);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        transition: all 0.2s ease-in-out;
        text-align: center;
        white-space: normal; /* Allow text to wrap */
        word-wrap: break-word; /* Ensure long words break */
    }
    .tracker-btn:hover { transform: translateY(-2px); box-shadow: 0 7px 0 #004d66, 0 10px 18px rgba(0,0,0,0.3); }
    .tracker-btn:active { transform: translateY(2px); box-shadow: 0 3px 0 #004d66, 0 5px 12px rgba(0,0,0,0.3); }
    
    /* Water Tracker Button redirect */
    .tracker-btn.water-tracker-link {
        text-decoration: none;
        display: inline-block;
    }


    /* Disease Prediction & Info Pages Buttons */
    .prediction-info-buttons {
        display: flex;
        flex-direction: column;
        gap: 15px; /* Space between buttons */
        padding: 20px; /* Padding inside the container */
    }
    .prediction-info-btn {
        padding: 18px 25px;
        font-size: 1.1em;
        font-weight: bold;
        color: #fff;
        background: linear-gradient(145deg, #4CAF50, #2E7D32); /* Green gradient */
        border: none;
        border-radius: 15px;
        cursor: pointer;
        box-shadow: 0 8px 0 #1B5E20, 0 12px 20px rgba(0,0,0,0.3);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        transition: all 0.2s ease-in-out;
        text-align: center;
        white-space: nowrap; /* Prevent text wrapping for these buttons */
    }
    .prediction-info-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 0 #1B5E20, 0 15px 25px rgba(0,0,0,0.35); }
    .prediction-info-btn:active { transform: translateY(3px); box-shadow: 0 4px 0 #1B5E20, 0 8px 15px rgba(0,0,0,0.3); }
    .back-icon {
        font-size: 1.1em;
        font-weight: bold;
        color: #008CBA;
        cursor: pointer;
        padding: 10px;
    }

    /* Floating Medical Assistant */
    #medical-assistant-float {
        position: fixed;
        bottom: 90px; /* Above bottom nav */
        right: 20px;
        background: linear-gradient(145deg, #0097c9, #007095);
        color: white;
        border-radius: 50%;
        width: 70px;
        height: 70px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        cursor: grab; /* Indicates it's draggable */
        z-index: 40;
        transition: transform 0.1s ease; /* Smooth hover but quick drag */
        text-align: center;
        overflow: hidden; /* To ensure the image corners are clipped */
    }
    #medical-assistant-float:hover {
        transform: translateY(-5px) scale(1.05);
        box-shadow: 0 8px 20px rgba(0,0,0,0.4);
    }
    #medical-assistant-float:active {
        cursor: grabbing;
    }
    #medical-assistant-float img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    #medical-assistant-float span {
        display: none; /* Hide the text as the image is self-explanatory */
    }

    /* Side Menu */
    #side-menu {
        position: fixed;
        top: 0;
        left: -80vw; /* Hidden by default */
        width: 80vw;
        max-width: 300px;
        height: 100%;
        background-color: #fff;
        box-shadow: 5px 0 15px rgba(0,0,0,0.2);
        z-index: 1000; /* High z-index to be on top */
        transition: left 0.3s ease-in-out;
        display: flex;
        flex-direction: column;
        padding-top: 20px;
    }
    #side-menu.open {
        left: 0;
    }
    .menu-header {
        font-size: 1.8em;
        font-weight: bold;
        color: #333;
        padding: 15px 20px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .close-menu {
        font-size: 2em;
        cursor: pointer;
        color: #999;
    }
    .menu-options {
        display: flex;
        flex-direction: column;
        padding: 20px;
        gap: 15px;
    }
    .menu-btn {
        width: 100%;
        padding: 15px 20px;
        font-size: 1.1em;
        font-weight: bold;
        color: #fff;
        background: linear-gradient(145deg, #0097c9, #007095);
        border: none;
        border-radius: 12px;
        cursor: pointer;
        box-shadow: 0 6px 0 #004d66, 0 10px 18px rgba(0,0,0,0.3);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        transition: all 0.2s ease-in-out;
        text-align: center;
    }
    .menu-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 0 #004d66, 0 12px 20px rgba(0,0,0,0.35); }
    .menu-btn:active { transform: translateY(3px); box-shadow: 0 3px 0 #004d66, 0 6px 12px rgba(0,0,0,0.3); }

    /* Profile Page specific styles */
    #profile-page {
        align-items: center;
        padding-top: 30px; /* Adjust as needed */
    }
    #profile-image-container {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background-color: #ddd;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        margin-bottom: 20px; /* Reduced margin */
        box-shadow: 0 8px 15px rgba(0,0,0,0.2), inset 0 0 10px rgba(0, 230, 255, 0.5);
        border: 2px solid rgba(0, 230, 255, 0.7);
        position: relative;
        cursor: pointer;
    }
    #profile-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    #profile-image-container input[type="file"] {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0;
        cursor: pointer;
    }
    #profile-image-placeholder {
        font-size: 0.9em;
        color: #555;
        text-align: center;
        padding: 10px;
    }
    
    /* New styles for Profile Form */
    #profile-form {
        display: none; /* MODIFIED: Initially hidden */
        flex-direction: column;
        gap: 15px;
        width: 90%;
        max-width: 400px;
        margin-bottom: 20px;
    }
    #profile-form .form-group {
        display: flex;
        flex-direction: column;
    }
    #profile-form label {
        margin-bottom: 5px;
        font-weight: 600;
        color: #333;
    }
    #profile-form input {
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #ccc;
        font-size: 1em;
    }

    /* Buttons container for Profile Page */
    .profile-buttons {
        display: flex;
        flex-direction: column;
        gap: 15px;
        width: 90%;
        max-width: 400px;
    }
    .profile-btn {
        padding: 16px 25px;
        font-size: 1.1em;
        font-weight: bold;
        color: #fff;
        background: linear-gradient(145deg, #0097c9, #007095);
        border: none;
        border-radius: 15px;
        cursor: pointer;
        box-shadow: 0 8px 0 #004d66, 0 12px 20px rgba(0,0,0,0.3);
        text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        transition: all 0.2s ease-in-out;
        text-align: center;
    }
    .profile-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 0 #004d66, 0 15px 25px rgba(0,0,0,0.35); }
    .profile-btn:active { transform: translateY(3px); box-shadow: 0 4px 0 #004d66, 0 8px 15px rgba(0,0,0,0.3); }
    .profile-btn.logout-btn { /* Specific style for logout */
        background: linear-gradient(145deg, #e53935, #b71c1c);
        box-shadow: 0 8px 0 #7f0000, 0 12px 20px rgba(0,0,0,0.3);
    }
    .profile-btn.logout-btn:hover { box-shadow: 0 10px 0 #7f0000, 0 15px 25px rgba(0,0,0,0.35); }
    .profile-btn.logout-btn:active { box-shadow: 0 4px 0 #7f0000, 0 8px 15px rgba(0,0,0,0.3); }

    /* New styles for Wallet Modal */
    #wallet-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        z-index: 1100;
        display: none; /* Hidden by default */
        justify-content: center;
        align-items: center;
        animation: fadeIn 0.3s;
    }
    .wallet-content {
        background-color: #f0f2f5;
        width: 90%;
        max-width: 450px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        overflow: hidden;
    }
    .wallet-header {
        background: transparent; /* Transparent as requested */
        padding: 15px;
        display: flex;
        align-items: center;
        position: relative;
    }
    .wallet-back-btn {
        font-size: 1.5em;
        font-weight: bold;
        color: #333;
        cursor: pointer;
    }
    .wallet-title {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.3em;
        font-weight: 700;
        color: #333;
    }
    .wallet-body {
        padding: 20px 30px 30px 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 25px;
    }
    .wallet-coin-card {
        width: 100%;
        aspect-ratio: 1 / 1;
        background-color: #fff;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 10px;
    }
    .wallet-coin-card .coin-icon {
        font-size: 3em;
    }
    .wallet-coin-card .coin-balance {
        font-size: 2.5em;
        font-weight: 800;
        color: #0077a2;
    }
     .wallet-coin-card .coin-label {
        font-size: 1em;
        color: #666;
    }
    .add-coins-btn {
        width: 100%;
        padding: 18px;
        font-size: 1.1em;
        font-weight: bold;
        color: #fff;
        background: linear-gradient(145deg, #4CAF50, #2E7D32);
        border: none;
        border-radius: 15px;
        cursor: pointer;
        box-shadow: 0 8px 0 #1B5E20, 0 12px 20px rgba(0,0,0,0.3);
        transition: all 0.2s ease-in-out;
    }
     .add-coins-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 0 #1B5E20, 0 15px 25px rgba(0,0,0,0.35); }
    .add-coins-btn:active { transform: translateY(3px); box-shadow: 0 4px 0 #1B5E20, 0 8px 15px rgba(0,0,0,0.3); }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }


    /* Bottom Navigation Bar */
    .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 70px; background-color: #fff; display: flex; justify-content: space-around; align-items: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 50; }
    .nav-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; color: #999; transition: color 0.3s; }
    .nav-item svg { width: 28px; height: 28px; fill: currentColor; margin-bottom: 4px; }
    .nav-item span { font-size: 12px; }
    .nav-item.active, .nav-item:hover { color: #008CBA; }

</style>

</head>
<body>

<div id="splash-screen">
    <img src="image/w.jpg" alt="Welcome Icon" id="caduceus-icon">
    <div id="welcome-text" class="splash-text">Welcome</div>
    <div id="shubhmed-text" class="splash-text">Shubhmed</div>
    <div class="model-card">
        <!-- MODIFICATION: Replaced canvas with img tag -->
        <img src="image/Welcome.png" alt="Welcome Image" id="welcome-image">
    </div>
    <div id="tagline" class="splash-text">See Your Health<br>Shape Your Future</div>
    <div id="buffer-loader"></div>
    <button id="start-button">Get Started</button>
</div>

<div id="dashboard-selection-screen">
    <button class="dashboard-btn" id="patient-dashboard-btn">Patient Dashboard</button>
    <button class="dashboard-btn" onclick="showFuturePlan()">Doctor Dashboard</button>
    <button class="dashboard-btn" onclick="showFuturePlan()">Pharmacy Dashboard</button>
    <button class="dashboard-btn" onclick="showFuturePlan()">Lab Dashboard</button>
</div>

<!-- HOME PAGE -->
<div id="home-page" class="page">
    <header id="header">
        <div class="menu-icon" onclick="showSideMenu()">&#9776;</div>
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search for anything...">
            <!-- MODIFICATION: Changed onclick to performSearch() -->
            <button class="search-button" onclick="performSearch()">&#128269;</button>
        </div>
        <div class="coin-display">
            <span class="coin-icon-emoji">🪙</span>
            <span id="header-coin-balance">0</span>
        </div>
    </header>

<div class="main-content">
    <div class="card-16-9" onclick="showFuturePlan()">
        <img src="https://i.ibb.co/4gwqRdRN/Fsz7-K1w-Qn6-TMo-AZNqj-Ehg.webp" alt="Health Banner">
    </div>
    <button class="action-button" onclick="window.location.href='Features/Medicinewaste.html'">Medicine Waste Change</button>
    <div class="cards-1-1-container">
        <div class="card-1-1" onclick="showFuturePlan()"><img src="https://i.ibb.co/DPC0kqZn/s-EQOZCNKT2-Cvj-NMiih4nvg.webp" alt="Pharmacy"></div>
        <div class="card-1-1" onclick="showFuturePlan()"><img src="https://i.ibb.co/LDqDXny5/5-MSTd-FGm-S1m-GCrb-Yg-z-Bg-A.webp" alt="Service 2"></div>
        <div class="card-1-1" onclick="showFuturePlan()"><img src="https://i.ibb.co/DHSVkn7T/Go9-8-Wo-STXCv-AO-SIQOoiw.webp" alt="Service 3"></div>
    </div>
    <h2 style="text-align: center; font-size: 1.6em; color: #333; margin-bottom: 15px;">Features</h2>
    <div class="features-container-16-9">
        <div class="features-section">
            <div class="features-grid">
                <div class="feature-item" onclick="showFuturePlan()"><svg viewBox="0 0 24 24"><path d="M20.57 14.86L22 13.43L20.57 12L17 15.57L8.43 7L12 3.43L10.57 2L9.14 3.43L7.71 2L5.57 4.14L4.14 2.71L2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57l3.43-3.43L17 20.57l1.43-1.43L20.57 22l2.14-2.14l-1.43-1.43l1.43-1.43l-1.43-1.43z M12 10.57L13.43 12L10.57 14.86L9.14 13.43z"></path></svg><span>Exercise Planner</span></div>
                <!-- MODIFIED: Link to Health.html -->
                <div class="feature-item" onclick="window.location.href='Features/Health.html'"><svg viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path></svg><span>Health Habit Builder</span></div>
                <!-- MODIFIED: Link to Diet.html -->
                <div class="feature-item" onclick="window.location.href='Features/Diet.html'"><svg viewBox="0 0 24 24"><path d="M16.5 4.5c1.9 0 3.5 1.6 3.5 3.5s-1.6 3.5-3.5 3.5-3.5-1.6-3.5-3.5 1.6-3.5 3.5-3.5m-3.9 6.5h-1.2c-1.1 0-2.2.4-2.9 1.2s-1.2 1.8-1.2 2.9v1.2c0 .6-.4 1-1 1s-1-.4-1-1v-1.2c0-1.7.7-3.4 1.9-4.6s2.9-1.9 4.6-1.9h1.2c.6 0 1 .4 1 1s-.4 1-1 1zm-1.6-6c-1.4 0-2.5 1.1-2.5 2.5s1.1 2.5 2.5 2.5 2.5-1.1 2.5-2.5-1.1-2.5-2.5-2.5zm4.5 6.5c-.3 0-.5.1-.7.3-.2.2-.3.4-.3.7s.1.5.3.7c.2.2.4.3.7.3s.5-.1.7-.3c.2-.2.3-.4.3-.7s-.1-.5-.3-.7c-.2-.2-.4-.3-.7-.3zM9 19H4v-5h5v5zm-1-4v3h-3v-3h3zm12-2h-5v5h5v-5zm-1 4v-3h-3v3h3z"></path></svg><span>AI Diet Planner</span></div>
                
                <!-- New Features -->
                <div class="feature-item" onclick="showFuturePlan()"><svg viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m0 16c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2"></path></svg><span>Advance Care</span></div>
                <div class="feature-item" onclick="showFuturePlan()"><svg viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11.5,17L12.5,14H11V8L12.5,11H14L12.5,14H14V17H11.5M12.5,10.5C13.06,10.5 13.5,10.06 13.5,9.5S13.06,8.5 12.5,8.5S11.5,8.94 11.5,9.5S11.94,10.5 12.5,10.5Z"></path></svg><span>Spine Health</span></div>
                <div class="feature-item" onclick="showFuturePlan()"><svg viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m-1-12h2v6h-2z"></path></svg><span>Mental Health</span></div>
                <div class="feature-item" onclick="showFuturePlan()"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-3.5 10c.83 0 1.5-.67 1.5-1.5S17.33 9 16.5 9s-1.5.67-1.5 1.5.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.83 9 9 9s-1.5.67-1.5 1.5.67 1.5 1.5 1.5z"></path></svg><span>CBT</span></div>
                <div class="feature-item" onclick="showFuturePlan()"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 2h6l-3.5 4.5-2.5-2.5-4 5V6z"></path></svg><span>Virtual Therapy</span></div>
                <div class="feature-item" onclick="showFuturePlan()"><svg viewBox="0 0 24 24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m-1-13h2v4h-2zm0 6h2v2h-2z"></path></svg><span>Pre Habilitation</span></div>
            </div>
        </div>
    </div>
</div>
</div>

<!-- Floating Medical Assistant -->
<div id="medical-assistant-float" onclick="window.location.href='Features/Assistant.html'">
    <img src="image/Assistant.jpg" alt="Medical Assistant">
    <span>Medical Assistant</span>
</div>


<!-- CARE PAGE -->
<div id="care-page" class="page">
    <header id="header">
        <div class="menu-icon" onclick="showSideMenu()">&#9776;</div>
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search care services...">
            <button class="search-button" onclick="showFuturePlan()">&#128269;</button>
        </div>
        <div class="coin-display">
            <span class="coin-icon-emoji">🪙</span>
            <span id="care-header-coin-balance">0</span>
        </div>
    </header>
    <div class="main-content">
        <div class="care-page-grid">
            <!-- Row 1 -->
            <div class="care-row">
                <div class="care-card-wrapper" onclick="showFuturePlan()">
                    <img src="image/skincare.jpg" alt="Skin Care">
                    <button class="care-3d-btn">Skin Care</button>
                </div>
                <div class="care-card-wrapper" onclick="showFuturePlan()">
                    <img src="image/dental care .jpg" alt="Dental Care">
                    <button class="care-3d-btn">Dental Care</button>
                </div>
                <div class="care-card-wrapper" onclick="window.location.href='Features/Eye.html'">
                    <img src="image/eye care .jpg" alt="Eye Care">
                    <button class="care-3d-btn">Eye Care</button>
                </div>
            </div>

        <!-- Row 2 -->
        <!-- ****************************************************** -->
        <!-- ***** THIS IS THE ONLY CHANGE MADE IN THIS UPDATE ***** -->
        <!-- ****************************************************** -->
        <div class="care-card-wrapper-16-9" onclick="window.location.href='Features/Womenhealth.html'">
            <img src="image/women's health .jpg" alt="Women Health Care">
            <button class="care-3d-btn">Women Health Care</button>
        </div>

        <!-- Row 3 -->
        <div class="care-row">
            <div class="care-card-wrapper" onclick="showFuturePlan()">
                <img src="image/ear.jpg" alt="Ear Care">
                <button class="care-3d-btn">Ear Care</button>
            </div>
            <div class="care-card-wrapper" onclick="showFuturePlan()">
                <img src="image/sexual health.jpg" alt="Sexual Health Care">
                <button class="care-3d-btn">Sexual Health</button>
            </div>
            <div class="care-card-wrapper" onclick="showFuturePlan()">
                <img src="image/elder care .jpg" alt="Elder Care">
                <button class="care-3d-btn">Elder Care</button>
            </div>
        </div>
    </div>
</div>
</div>

<!-- TRACKER PAGE -->
<div id="tracker-page" class="page">
    <header id="header">
        <div class="menu-icon" onclick="showSideMenu()">&#9776;</div>
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search for trackers...">
            <button class="search-button" onclick="showFuturePlan()">&#128269;</button>
        </div>
        <div class="coin-display">
            <span class="coin-icon-emoji">🪙</span>
            <span id="tracker-header-coin-balance">0</span>
        </div>
    </header>
    <div class="main-content">
        <div class="tracker-grid">
            <!-- Card 1 -->
            <div class="tracker-card-item">
                <img src="image/water intake tracker .jpg" alt="Water Intake Tracker">
                <a href="Features/water.html" class="tracker-btn water-tracker-link">Water Intake Tracker</a>
            </div>
            <!-- Card 2 -->
            <div class="tracker-card-item">
                <img src="image/child.jpg" alt="Child Growth Tracker">
                <button class="tracker-btn" onclick="showFuturePlan()">Child Growth Tracker</button>
            </div>
            <!-- Card 3 -->
            <div class="tracker-card-item">
                <img src="image/copd.jpg" alt="COPD Tracker">
                <button class="tracker-btn" onclick="showFuturePlan()">COPD Tracker</button>
            </div>
            <!-- Card 4 -->
            <div class="tracker-card-item">
                <img src="image/sleep.jpg" alt="Sleep Tracker">
                <button class="tracker-btn" onclick="showFuturePlan()">Sleep Tracker</button>
            </div>
            <!-- Card 5 -->
            <div class="tracker-card-item">
                <img src="image/prenatal fitness .jpg" alt="Prenatal Fitness">
                <button class="tracker-btn" onclick="showFuturePlan()">Prenatal Fitness</button>
            </div>
            <!-- Card 6 -->
            <div class="tracker-card-item">
                <img src="image/brain.jpg" alt="Brain Training">
                <button class="tracker-btn" onclick="showFuturePlan()">Brain Training</button>
            </div>
            <!-- Card 7 -->
            <div class="tracker-card-item">
                <img src="image/gut analysers.jpg" alt="Gut Analyser">
                <button class="tracker-btn" onclick="showFuturePlan()">Gut Analyser</button>
            </div>
            <!-- Card 8 -->
            <div class="tracker-card-item">
                <img src="image/meditation.jpg" alt="Meditation">
                <button class="tracker-btn" onclick="window.location.href='Features/Meditation.html'">Meditation</button>
            </div>
            <!-- Card 9 -->
            <div class="tracker-card-item">
                <img src="image/elder health tracker.jpg" alt="Elder Health Tracker">
                <button class="tracker-btn" onclick="showFuturePlan()">Elder Health Tracker</button>
            </div>
            <!-- Card 10 -->
            <div class="tracker-card-item">
                <img src="image/family health hub.jpg" alt="Family Health Hub">
                <button class="tracker-btn" onclick="showFuturePlan()">Family Health Hub</button>
            </div>
            <!-- Card 11 -->
            <div class="tracker-card-item">
                <img src="image/disease prediction.jpg" alt="Disease Prediction">
                <button class="tracker-btn" data-target-page="disease-prediction">Disease Prediction</button>
            </div>
            <!-- Card 12 -->
            <div class="tracker-card-item">
                <img src="image/disease info.jpg" alt="Disease Info">
                <button class="tracker-btn" data-target-page="disease-info">Disease Info</button>
            </div>
        </div>
    </div>
</div>

<!-- DISEASE PREDICTION PAGE -->
<div id="disease-prediction-page" class="page">
    <header id="header">
        <div class="back-icon" onclick="goBackToTracker()">&#8592; Back</div>
        <div style="flex-grow: 1; text-align: center; font-weight: bold; font-size: 1.2em; color: #333;">Disease Prediction</div>
        <div class="coin-display">
            <span class="coin-icon-emoji">🪙</span>
            <span id="prediction-header-coin-balance">0</span>
        </div>
    </header>
    <div class="main-content prediction-info-buttons">
        <button class="prediction-info-btn" onclick="showFuturePlan()">Heart Attack Prediction</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Stroke Risk Prediction</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Chronic Disease Prediction</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Cancer Screening</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Diabetes Prediction</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Allergy Prediction</button>
    </div>
</div>

<!-- DISEASE INFO PAGE -->
<div id="disease-info-page" class="page">
    <header id="header">
        <div class="back-icon" onclick="goBackToTracker()">&#8592; Back</div>
        <div style="flex-grow: 1; text-align: center; font-weight: bold; font-size: 1.2em; color: #333;">Disease Information</div>
        <div class="coin-display">
            <span class="coin-icon-emoji">🪙</span>
            <span id="info-header-coin-balance">0</span>
        </div>
    </header>
    <div class="main-content prediction-info-buttons">
        <button class="prediction-info-btn" onclick="showFuturePlan()">CPR Learning</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Rare Disease Learning</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Emergency Medical Info</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">First Aid Guide</button>
        <button class="prediction-info-btn" onclick="showFuturePlan()">Longevity Health Span</button>
    </div>
</div>

<!-- CONSULTANT PAGE -->
<div id="consultant-page" class="page">
    <header id="header">
        <div class="menu-icon" onclick="showSideMenu()">&#9776;</div>
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search for doctors...">
            <button class="search-button" onclick="showFuturePlan()">&#128269;</button>
        </div>
        <div class="coin-display">
            <span class="coin-icon-emoji">🪙</span>
            <span id="consultant-header-coin-balance">0</span>
        </div>
    </header>
    <div class="main-content">
        <h2 style="text-align: center; font-size: 1.6em; color: #333; margin-top: 15px;">Our Consultants</h2>
        <p style="text-align: center; color: #666;">Doctor list will appear here in a future update.</p>
        <!-- Placeholder for doctor list -->
    </div>
</div>

<!-- PROFILE PAGE -->
<div id="profile-page" class="page">
    <header id="header">
        <!-- These elements are hidden by CSS -->
        <div class="menu-icon" onclick="showSideMenu()">&#9776;</div>
        <div class="search-container">
            <input type="text" class="search-bar" placeholder="Search profile options...">
            <button class="search-button" onclick="showFuturePlan()">&#128269;</button>
        </div>
        <div class="coin-display">
            <span class="coin-icon-emoji">🪙</span>
            <span>100</span>
        </div>
        <!-- Title for the profile page header -->
        <div style="font-weight: bold; font-size: 1.2em; color: #333;">Profile</div>
    </header>
    <div class="main-content" style="display: flex; flex-direction: column; align-items: center;">
        <div id="profile-image-container">
            <img id="profile-picture" src="" alt="Profile Picture" style="display: none;">
            <span id="profile-image-placeholder">Tap to add image</span>
            <input type="file" id="profile-image-upload" accept="image/*">
        </div>

        <form id="profile-form">
            <div class="form-group">
                <label for="profile-name">Name</label>
                <input type="text" id="profile-name" placeholder="Your Name">
            </div>
            <div class="form-group">
                <label for="profile-email">Email</label>
                <input type="email" id="profile-email" placeholder="Your Email">
            </div>
            <div class="form-group">
                <label for="profile-phone">Phone Number</label>
                <input type="tel" id="profile-phone" placeholder="Your Phone Number">
            </div>
            <div class="form-group">
                <label for="profile-address">Address</label>
                <input type="text" id="profile-address" placeholder="Your Address">
            </div>
        </form>

        <!-- MODIFIED: Wrapped buttons in containers to show/hide them -->
        <div id="profile-main-buttons" class="profile-buttons">
            <button class="profile-btn" id="edit-profile-btn">Edit Profile</button>
            <button class="profile-btn" id="wallet-btn">Wallet</button>
            <button class="profile-btn logout-btn" id="logout-btn">Log Out</button>
        </div>
        
        <div id="profile-edit-buttons" class="profile-buttons" style="display: none;">
            <button class="profile-btn" id="save-profile-btn">Save Profile</button>
            <button class="profile-btn logout-btn" id="cancel-edit-btn">Cancel</button>
        </div>
    </div>
</div>

<!-- SIDE MENU -->
<div id="side-menu">
    <div class="menu-header">Menu <span class="close-menu" onclick="hideSideMenu()">&times;</span></div>
    <div class="menu-options">
        <button class="menu-btn" onclick="showFuturePlan()">Appointment Management</button>
        <button class="menu-btn" onclick="showFuturePlan()">Holistic Chronic Pain Management</button>
        <button class="menu-btn" onclick="showFuturePlan()">Health Insurance</button>
        <button class="menu-btn" onclick="showFuturePlan()">Medical Bill</button>
    </div>
</div>

<!-- WALLET MODAL (New) -->
<div id="wallet-modal">
    <div class="wallet-content">
        <div class="wallet-header">
            <span class="wallet-back-btn" onclick="closeWallet()">&#8592;</span>
            <span class="wallet-title">Wallet</span>
        </div>
        <div class="wallet-body">
            <div class="wallet-coin-card">
                <div class="coin-icon">🪙</div>
                <div class="coin-balance" id="wallet-coin-balance-display">0</div>
                <div class="coin-label">Available Coins</div>
            </div>
            <button class="add-coins-btn" id="add-coins-btn">Add Coins (₹1 = 5 Coins)</button>
        </div>
    </div>
</div>


<nav class="bottom-nav">
    <div class="nav-item active" id="nav-home"><svg viewBox="0 0 24 24"><path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"></path></svg><span>Home</span></div>
    <div class="nav-item" id="nav-consultant"><svg viewBox="0 0 24 24"><path d="M20,6H16V2H8V6H4C2.9,6 2,6.9 2,8V19C2,20.1 2.9,21 4,21H20C21.1,21 22,20.1 22,19V8C22,6.9 21.1,6 20,6M10,4H14V6H10V4M20,19H4V8H20V19M12,10.5L14,12.5L12,14.5L10,12.5L12,10.5Z"></path></svg><span>Consultant</span></div>
    <div class="nav-item" id="nav-care"><svg viewBox="0 0 24 24"><path d="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2M12,20C7.59,20 4,16.41 4,12C4,11.56 4.05,11.12 4.14,10.7C5.9,10.14 7.5,9 7.5,7C7.5,6.05 7.08,5.19 6.4,4.58C7.5,3.14 9.12,2.29 11,2.06C11.33,3.15 12.28,4 13.5,4C14.72,4 15.67,3.15 16,2.06C17.88,2.29 19.5,3.14 20.6,4.58C19.92,5.19 19.5,6.05 19.5,7C19.5,9 21.1,10.14 22.86,10.7C22.95,11.12 23,11.56 23,12C22.97,16.41 19.41,20 15,20H9Z"></path></svg><span>Care</span></div>
    <div class="nav-item" id="nav-tracker"><svg viewBox="0 0 24 24"><path d="M3,3H21V5H3V3M3,7H15V9H3V7M3,11H21V13H3V11M3,15H15V17H3V15M3,19H21V21H3V19Z"></path></svg><span>Tracker</span></div>
    <div class="nav-item" id="nav-profile"><svg viewBox="0 0 24 24"><path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"></path></svg><span>Profile</span></div>
</nav>

<script type="module">
    // MODIFICATION: Removed 3D model related imports as they are no longer used
    // import * as THREE from 'three';
    // import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
    // import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    // =================================================================================
    // ===== START: FIREBASE SDK SETUP =====
    // =================================================================================

    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";

    // Your web app's Firebase configuration
    // This config is for your 'shubhmed-9f05d' project
    const firebaseConfig = {
      apiKey: "AIzaSyC7ojmyQMg2ljB7kT4MQSmIhz43QNHpE0w",
      authDomain: "shubhmed-9f05d.firebaseapp.com",
      databaseURL: "https://shubhmed-9f05d-default-rtdb.firebaseio.com",
      projectId: "shubhmed-9f05d",
      storageBucket: "shubhmed-9f05d.firebasestorage.app",
      messagingSenderId: "42179676197",
      appId: "1:42179676197:web:1796559543fb869c5297cc",
      measurementId: "G-VD9YFFECTC"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const analytics = getAnalytics(app);

    // =================================================================================
    // ===== END: FIREBASE SDK SETUP =====
    // =================================================================================

    // --- Element References ---
    const splashScreen = document.getElementById('splash-screen');
    const dashboardSelectionScreen = document.getElementById('dashboard-selection-screen');
    const homePage = document.getElementById('home-page');
    const carePage = document.getElementById('care-page');
    const trackerPage = document.getElementById('tracker-page'); 
    const diseasePredictionPage = document.getElementById('disease-prediction-page'); 
    const diseaseInfoPage = document.getElementById('disease-info-page'); 
    const consultantPage = document.getElementById('consultant-page'); 
    const profilePage = document.getElementById('profile-page'); 
    const sideMenu = document.getElementById('side-menu'); 
    const loader = document.getElementById('buffer-loader');
    const startButton = document.getElementById('start-button');
    const patientDashboardButton = document.getElementById('patient-dashboard-btn');
    const navItems = document.querySelectorAll('.nav-item');
    const navHome = document.getElementById('nav-home');
    const navConsultant = document.getElementById('nav-consultant'); 
    const navCare = document.getElementById('nav-care');
    const navTracker = document.getElementById('nav-tracker'); 
    const navProfile = document.getElementById('nav-profile'); 
    const medicalAssistantFloat = document.getElementById('medical-assistant-float');

    const profilePictureInput = document.getElementById('profile-image-upload');
    const profilePictureImg = document.getElementById('profile-picture');
    const profilePicturePlaceholder = document.getElementById('profile-image-placeholder');

    const walletModal = document.getElementById('wallet-modal');

    // --- Page Navigation Logic ---
    function switchPage(pageToShow) {
        document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
        if (pageToShow) {
            pageToShow.style.display = 'flex';
            if (sideMenu && sideMenu.classList.contains('open')) {
                hideSideMenu();
            }
        }
    }

    function updateActiveNav(activeItem) {
        navItems.forEach(item => item.classList.remove('active'));
        if (activeItem) {
            activeItem.classList.add('active');
        }
    }
    
    navHome.onclick = () => {
        switchPage(homePage);
        updateActiveNav(navHome);
    };

    navConsultant.onclick = () => {
        switchPage(consultantPage);
        updateActiveNav(navConsultant);
    };

    navCare.onclick = () => {
        switchPage(carePage);
        updateActiveNav(navCare);
    };

    navTracker.onclick = () => {
        switchPage(trackerPage);
        updateActiveNav(navTracker);
    };

    navProfile.onclick = () => {
        switchPage(profilePage);
        updateActiveNav(navProfile);
    };
    
    // --- Splash Screen Logic ---
    function initializeWelcomeSequence() {
        setTimeout(() => {
            if(loader) loader.style.display = 'block';
            setTimeout(() => {
                if(loader) loader.style.display = 'none';
                if(startButton) startButton.style.display = 'block';
            }, 3000); 
        }, 2000);
    }

    function proceedToDashboardSelection() {
        if (splashScreen) {
            splashScreen.style.opacity = '0';
            splashScreen.style.visibility = 'hidden';
            setTimeout(() => { splashScreen.style.display = 'none'; }, 1500);
        }
        if (dashboardSelectionScreen) {
            dashboardSelectionScreen.style.display = 'flex';
        }
    }

    if (startButton) {
        startButton.onclick = proceedToDashboardSelection;
    }

    if (patientDashboardButton) {
        patientDashboardButton.onclick = function() {
            if (dashboardSelectionScreen) {
                dashboardSelectionScreen.style.display = 'none';
            }
            switchPage(homePage);
            updateActiveNav(navHome);
            document.body.style.overflow = 'auto';
        }
    }
    
    // --- Side Menu Logic ---
    function showSideMenu() {
        if (sideMenu) {
            sideMenu.classList.add('open');
            const overlay = document.createElement('div');
            overlay.id = 'menu-overlay';
            overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 999;';
            overlay.onclick = hideSideMenu;
            document.body.appendChild(overlay);
        }
    }

    function hideSideMenu() {
        if (sideMenu) {
            sideMenu.classList.remove('open');
            const overlay = document.getElementById('menu-overlay');
            if (overlay) {
                overlay.remove();
            }
        }
    }

    // --- Back Button Function for Prediction/Info Pages ---
    function goBackToTracker() {
        switchPage(trackerPage);
        updateActiveNav(navTracker);
    }

    // --- Draggable Medical Assistant Button ---
    if (medicalAssistantFloat) {
        let isDragging = false;
        let wasDragged = false; // Flag to distinguish drag from click
        let currentX;
        let currentY;
        let initialX;
        let initialY;
        let xOffset = 0;
        let yOffset = 0;

        medicalAssistantFloat.addEventListener("touchstart", dragStart, false);
        medicalAssistantFloat.addEventListener("touchend", dragEnd, false);
        medicalAssistantFloat.addEventListener("touchmove", drag, false);

        medicalAssistantFloat.addEventListener("mousedown", dragStart, false);
        medicalAssistantFloat.addEventListener("mouseup", dragEnd, false);
        medicalAssistantFloat.addEventListener("mousemove", drag, false);

        medicalAssistantFloat.addEventListener('click', (e) => {
            if (wasDragged) {
                e.preventDefault(); // Prevent navigation if it was a drag
                wasDragged = false; // Reset flag
            }
        });


        function dragStart(e) {
            wasDragged = false;
            if (e.type === "touchstart") {
                initialX = e.touches[0].clientX - xOffset;
                initialY = e.touches[0].clientY - yOffset;
            } else {
                initialX = e.clientX - xOffset;
                initialY = e.clientY - yOffset;
            }

            if (e.target === medicalAssistantFloat || medicalAssistantFloat.contains(e.target)) {
                isDragging = true;
            }
        }

        function dragEnd(e) {
            initialX = currentX;
            initialY = currentY;
            isDragging = false;
        }

        function drag(e) {
            if (isDragging) {
                e.preventDefault();
                wasDragged = true;

                if (e.type === "touchmove") {
                    currentX = e.touches[0].clientX - initialX;
                    currentY = e.touches[0].clientY - initialY;
                } else {
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;
                }

                xOffset = currentX;
                yOffset = currentY;

                setTranslate(currentX, currentY, medicalAssistantFloat);
            }
        }

        function setTranslate(xPos, yPos, el) {
            el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
        }
    }

    // --- Profile Image Upload and Local Storage ---
    function loadProfileImage() {
        const savedImage = localStorage.getItem('profileImage');
        if (savedImage) {
            profilePictureImg.src = savedImage;
            profilePictureImg.style.display = 'block';
            profilePicturePlaceholder.style.display = 'none';
        } else {
            profilePictureImg.style.display = 'none';
            profilePicturePlaceholder.style.display = 'block';
        }
    }

    if (profilePictureInput) {
        profilePictureInput.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageDataUrl = e.target.result;
                    localStorage.setItem('profileImage', imageDataUrl);
                    loadProfileImage();
                };
                reader.readAsDataURL(file);
            }
        });
    }

    // =================================================================================
    // ===== START: PROFILE, WALLET, AND AUTH LOGIC =====
    // =================================================================================

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            console.log("User is signed in:", user.uid);
            const userRef = doc(db, "users", user.uid);
            const userDoc = await getDoc(userRef);

            if (!userDoc.exists()) {
                console.log("New user detected. Creating profile with 50 coins.");
                await setDoc(userRef, {
                    uid: user.uid,
                    name: "", email: "", phone: "", address: "",
                    coins: 50,
                    createdAt: new Date()
                });
                updateCoinDisplays(50);
            } else {
                const userData = userDoc.data();
                console.log("Existing user data:", userData);
                updateCoinDisplays(userData.coins || 0);
                document.getElementById('profile-name').value = userData.name || "";
                document.getElementById('profile-email').value = userData.email || "";
                document.getElementById('profile-phone').value = userData.phone || "";
                document.getElementById('profile-address').value = userData.address || "";
            }

        } else {
            console.log("No user signed in. Signing in anonymously...");
            signInAnonymously(auth).catch((error) => {
                console.error("Anonymous sign-in failed:", error);
                alert("Could not connect to the server. Please refresh.");
            });
        }
    });
    
    function updateCoinDisplays(balance) {
        document.getElementById('header-coin-balance').textContent = balance;
        document.getElementById('care-header-coin-balance').textContent = balance;
        document.getElementById('tracker-header-coin-balance').textContent = balance;
        document.getElementById('prediction-header-coin-balance').textContent = balance;
        document.getElementById('info-header-coin-balance').textContent = balance;
        document.getElementById('consultant-header-coin-balance').textContent = balance;
        document.getElementById('wallet-coin-balance-display').textContent = balance;
    }

    async function saveProfileData() {
        const user = auth.currentUser;
        if (!user) {
            alert("You are not logged in. Please refresh the page.");
            return;
        }

        const name = document.getElementById('profile-name').value;
        const email = document.getElementById('profile-email').value;
        const phone = document.getElementById('profile-phone').value;
        const address = document.getElementById('profile-address').value;

        const userRef = doc(db, "users", user.uid);
        try {
            await updateDoc(userRef, { name, email, phone, address });
            alert("Profile saved successfully!");
            showMainProfileView(); 
        } catch (error) {
            console.error("Error saving profile: ", error);
            alert("Failed to save profile. Please try again.");
        }
    }
    
    function openWallet() {
        if (walletModal) walletModal.style.display = 'flex';
    }

    window.closeWallet = function() {
        if (walletModal) walletModal.style.display = 'none';
    }

    async function initiateAddCoins() {
        // This function would ideally call a backend to create a Razorpay order
        alert("Payment gateway integration is a future plan.");
    }

    function logOut() {
        signOut(auth).then(() => {
            localStorage.removeItem('profileImage');
            alert('Logged out successfully!');
            window.location.reload();
        }).catch((error) => {
            console.error("Logout failed:", error);
        });
    }

    const profileForm = document.getElementById('profile-form');
    const profileMainButtons = document.getElementById('profile-main-buttons');
    const profileEditButtons = document.getElementById('profile-edit-buttons');

    function showEditProfileView() {
        profileMainButtons.style.display = 'none';
        profileForm.style.display = 'flex';
        profileEditButtons.style.display = 'flex';
    }

    function showMainProfileView() {
        profileMainButtons.style.display = 'flex';
        profileForm.style.display = 'none';
        profileEditButtons.style.display = 'none';
    }

    // =================================================================================
    // ===== END: PROFILE, WALLET, AND AUTH LOGIC =====
    // =================================================================================


    window.showFuturePlan = function() {
        alert('This feature is part of a future update.');
    }

    window.performSearch = function() {
        const searchInput = document.querySelector('.page[style*="display: flex"] .search-bar');
        const searchTerm = searchInput.value.trim().toLowerCase();

        if (searchTerm === "") {
            alert("Please enter a search term.");
            return;
        }
        
        // Simple search logic
        if (searchTerm.includes("care")) { switchPage(carePage); updateActiveNav(navCare); } 
        else if (searchTerm.includes("tracker")) { switchPage(trackerPage); updateActiveNav(navTracker); } 
        else if (searchTerm.includes("doctor")) { switchPage(consultantPage); updateActiveNav(navConsultant); }
        else if (searchTerm.includes("profile")) { switchPage(profilePage); updateActiveNav(navProfile); }
        else if (searchTerm.includes("meditation")) { window.location.href = 'Features/Meditation.html'; }
        else if (searchTerm.includes("diet")) { window.location.href = 'Features/Diet.html'; }
        else { alert(`No results found for "${searchInput.value}".`); }
    }

    // --- Initialization ---
    document.addEventListener('DOMContentLoaded', () => {
        initializeWelcomeSequence();
        loadProfileImage();

        document.querySelectorAll('.tracker-btn').forEach(button => {
            button.addEventListener('click', (event) => {
                if(button.classList.contains('water-tracker-link')) return; 

                const pageTarget = button.getAttribute('data-target-page');
                if (pageTarget) {
                    event.preventDefault(); 
                    if (pageTarget === 'disease-prediction') { switchPage(diseasePredictionPage); } 
                    else if (pageTarget === 'disease-info') { switchPage(diseaseInfoPage); }
                }
            });
        });
        
        document.querySelectorAll('.search-bar').forEach(input => {
            input.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    performSearch();
                }
            });
        });
        
        document.getElementById('edit-profile-btn').addEventListener('click', showEditProfileView);
        document.getElementById('cancel-edit-btn').addEventListener('click', showMainProfileView);
        document.getElementById('save-profile-btn').addEventListener('click', saveProfileData);
        
        document.getElementById('wallet-btn').addEventListener('click', openWallet);
        document.getElementById('logout-btn').addEventListener('click', logOut);
        document.getElementById('add-coins-btn').addEventListener('click', initiateAddCoins);

        window.goBackToTracker = goBackToTracker;
        window.showSideMenu = showSideMenu;
        window.hideSideMenu = hideSideMenu;
    });

</script>

</body>
</html>
